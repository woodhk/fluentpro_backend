[tool:pytest]
# Django settings
DJANGO_SETTINGS_MODULE = config.settings.testing
python_files = tests.py test_*.py *_tests.py *_test.py
python_classes = Test* *Tests *Test
python_functions = test_*

# Test discovery
testpaths = tests
minversion = 7.0
addopts = 
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --cov=domains
    --cov=infrastructure
    --cov=application
    --cov=api
    --cov-report=term-missing
    --cov-report=html:htmlcov
    --cov-fail-under=80
    --asyncio-mode=auto
    --reuse-db
    --nomigrations

# Async support
asyncio_mode = auto

# Custom markers
markers =
    slow: marks tests as slow (deselect with '-m "not slow"')
    integration: marks tests as integration tests
    unit: marks tests as unit tests
    external: marks tests that require external services
    auth: marks tests related to authentication
    onboarding: marks tests related to onboarding
    mock: marks tests using mocked dependencies
    database: marks tests that require database access
    redis: marks tests that require Redis
    celery: marks tests that require Celery workers
    websocket: marks tests that require WebSocket connections

# Test collection
collect_ignore = 
    setup.py
    venv
    env
    node_modules
    .git

# Timeout settings
timeout = 300
timeout_method = thread

# Warnings
filterwarnings =
    ignore::UserWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore:.*:django.utils.deprecation.RemovedInDjango*